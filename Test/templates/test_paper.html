{% extends 'main.html' %}

{% block title %} Welcome to Online Testing System {% endblock title %}

{%block top %} 
{% load static %}
    <link rel="stylesheet" href="{% static 'exam1.css ' %}" />
      
       
{% endblock top%}
{%block style%}


.exam-page 
{
    background-image: linear-gradient(rgba(248, 241, 241,0.7),rgba(219, 201, 176, 0.3));
    /* background-image: linear-gradient(rgba(248, 241, 241,0.7),rgba(180, 219, 176, 0.3)); */
    /* padding: 10px; */
}
.exam-section  .info-sec 
{
    /* margin: 20px; */
     border: 3px solid rgb(17, 51, 154);
    padding: 10px;
    display: grid;
    height: 100%;
    max-height: 300px;
    align-items: center;
    place-items: center;
    place-content: start;
    justify-content: space-around;
    border-radius: 5px;
    margin-bottom: 10px;
    width: 115%;
    background-color: rgb(215, 239, 212);
    position:sticky;
    top:0px;
}
.exam-section  .info-sec .head h4 
{
    font-size: 20px;
    margin: 5px;
    /* border: 2px solid red; */
    
}
.exam-section .info-sec .head 
{
    display: grid;
    height: 90%;
    background-color: rgb(215, 239, 212); 
    /* position:sticky; */
    /* border: 2px solid black; */


}
.exam-section .questionimg .info-sec .head h4 
{
    font-size: 19px;
    
}
.head h4 span
{
    color: rgb(228, 45, 32);
}
.exam-section .questionimg .info-sec h4 span 
{
    color: rgb(10, 10, 102);
}
.exam-page .exam-header{
   display: flex;
   align-items: center;
   justify-content: center;
   flex-wrap: wrap;
   /* margin: 20px; */

}
.exam-page .exam-header h2 
{
    color: rgb(11, 41, 12);
    font-size: 140%;
   border: 2px solid black;
   padding: 10px;
   border-radius: 10px 0px;
   box-shadow: 10px -10px 100px rgb(32, 160, 3);
   /* background-color: rgb(141, 137, 133); */
   background-image: linear-gradient(rgba(200, 202, 210, 0.7),rgba(236, 236, 236, 0.7));

}
.exam-section
{
    margin: 20px;
    border: 3px solid rgb(12, 14, 20);
    padding: 10px;
    display: grid;
    column-gap: 30px;
    grid-template-columns: 0fr auto;
    /* border-radius: 5px; */
    margin-top: 10px;
    padding-top: 30px;
    place-items: start;
    border-left: 0px;
    border-right: 0px;
    border-bottom: 0px;


   
    /* background-color: greenyellow; */
}
.exam-section .questionimg
{
    /* border: 2px solid red; */
    border:2px solid royalblue;
    border-radius: 10px 10px;

    /* width: 80%; */
    /* display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column; */
    display: grid;
    place-items: center;
    padding: 10px;

}
.qhead
{
    display: flex;
    align-items: flex-start;
    justify-content: flex-start;
    width:90%;
}
#qnum 
{
   margin:0px;
}
.exam-section .questionimg .qimg small
{
    border: 1px solid green;

}
.exam-section .questionimg .qimg 
{
    border: 3px solid green;
    /* margin: 10px; */
    margin-bottom: 0px;
    width: 90%;
    border-radius: 5px;
    background-color: white;
    align-items: flex-start;
}
.exam-section .questionimg .qimg img 
{
    width: 100%;
}
.exam-section .questionimg .optGroup
{
    border: 2px solid black;
    display: flex;
    align-items: center;
    justify-content: space-around;
    flex-wrap: wrap;
    flex-direction: row;
    margin-bottom: 20px;
    margin-top: 0px;
    padding: 10px;
    width: 90%;
    border-radius: 5px;
}
.exam-section .questionimg .optGroup .options
{
    font-size: 20px;
}
.exam-section .exam-btn
{
    border: 2px solid rgb(17, 51, 154);
   
    width: 90%;
    padding: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 5px;

}
.exam-section .exam-btn input
{
    color: white;
    background-color: rgb(44, 89, 225);
    font-size: 18px;
    width: 80px;
    height: 40px;
    border-radius: 4px;
}

.launch-time{
    display: grid;
    grid-template-columns: auto auto auto auto auto auto;
    border: 3px solid rgb(17, 51, 154);
    /* border-top:0px ; */
    border-left:0px ;
    border-right: 0px;
    margin-top: 20px;
    /* position: sticky;
    top: 0px; */
 }
 .launch-time div
 {
   /* flex-basis: 50px; */
   width: 100%;
   margin: 2px;
   height: 10%;
   /* max-width: 150px; */
 }
 .launch-time div #colon
 {
    color: rgb(37, 48, 20);
 }
 .launch-time div p
 {
    font-size: 30px;
    margin-bottom: -14px;
    color: rgb(228, 45, 32);
    /* border: 2px solid green; */
 }
 .launch-time div span {
    margin: 2px;
    font-size: 13px;
    /* border: 2px solid green; */


 }
@media(max-width:700px)
{
    .exam-section
    {
        grid-template-columns: auto;
        margin: 5px;
        padding: 0px;
        padding-top:10px;
        padding-bottom: 10px;
        place-items: center;
        
    }
    .exam-section  .info-sec 
    {
    /* margin: 20px; */
        border: 3px solid rgb(17, 51, 154);
        padding: 5px;
        display: grid;
        grid-template-columns: auto auto;
        row-gap: 5px;
        height: 100%;
        width: 90%;
    }
    .exam-section .questionimg 
    {
        width: 90%;
    }
    .exam-section .questionimg .qimg 
    {
       
        width: 100%;
    } 
    .exam-section .questionimg .optGroup
    {
        width: 100%;
    }
    .exam-section .questionimg .qimg img 
    {
        width: 90%;
    }
    .exam-section .questionimg .info-sec{
        width: 100%;

    }
    .exam-section .exam-btn
    {
        width: 100%;
    }
    .launch-time
    {
        position: sticky;
        top: 0px;
    }
    .launch-time div #colon
    {
       color: rgb(37, 48, 20);
    }
    .launch-time div{
        height: 10%;
    }
    .launch-time div p
    {
       font-size: 25px;
       margin-bottom: -12px;
       color: rgb(228, 45, 32);
    }
    .launch-time div span {
       margin: 2px;
       font-size: 11px;
    }
    
    
}
@media(orientation:landscape)
{
    .exam-section .questionimg .qimg img
    {
        width: 99%;
       max-width: 500px;
    }
    .exam-section .questionimg 
    {
        width: 90%;
    }
    
}


{%endblock style%}

{%block content %}

    <form id="form" action="{% url 'Test:calculateTest' %}" method ="POST" >
        {% csrf_token %}

        {% if examStatus == 1 %}
        <!-- Question will be in the form of image -->
        <div class="exam-page">

            <div class="exam-header">
                <h2>Exam Section</h2>
            </div>
            
            <div class="exam-section">     
                    
                <div class="info-sec">
                    
                    <div class="head">
                    <h4>Name :<span> {{ request.session.name }}</span></h4>
                    
                    <h4>Total Question : <span>{{ totalQuestion }}</span>
                    </h4>
                    <h4>Topic Name : <span>{{ topicName }}</span></h4>
                    <h4>Total Time :<span>{{time}} min</span></h4>
                    <h4>Time Remaining :</h4>
                    </div>
                    <div class="launch-time">
                        
                        <div>
                            <p id ="hours">00</p>
                            <span>Hours</span>
                        </div>
                        <div>
                            <p id="colon">:</p>
                        </div>
                        <div>
                            <p id = "minutes">00</p>
                            <span>Minutes</span>
                        </div>
                        <div>
                            <p id="colon">:</p>
                        </div>
                        <div>
                            <p id ="seconds">00</p>
                            <span>Second</span>
                        </div>
                    </div>

                </div> 
                <div class="questionimg">
                    {%for img in questions %}
                
                       <div class="qhead">
                        <p id ="qnum">Q.{{forloop.counter}} {{img.question_title}}</p>
                        </div>

                    <div class="qimg"> <img src="{{img.question_image.url}}" alt="question not found" ></div>
                
                    <input type = "hidden" name ="qno{{img.question_id}}" value = "{{img.question_id}}">
                
                    <div class = "optGroup">
                        <div class ="options"> <input type="radio" , id ="op{{img.question_id}}" name ="op{{img.question_id}}" value = "a">A.</div>
                        <div class ="options"> <input type="radio" , id ="op{{img.question_id}}" name ="op{{img.question_id}}" value = "b">B.</div>
                        <div class ="options"> <input type="radio" , id ="op{{img.question_id}}" name ="op{{img.question_id}}" value = "c">C.</div>
                        <div class ="options"> <input type="radio" ,  id ="op{{img.question_id}}" name ="op{{img.question_id}}" value = "d">D.</div>
                    </div>
               
                {% endfor %}

                <div class="exam-btn">
                    <input type="submit" value = "Submit" id = "refreshed" value="no">

                </div>
            </div>
            
            
        </div>
        {% elif examStatus == 2 %}
        <h1>Sorry..! please Enter valid topic names </h1>
        {% endif %}
   </form>
      
   <script>
    let output = document.getElementById("output")
    $("#btn").click(function(){
            $("input[type=radio] [name= op{{img.question_id}} ]").prop('checked',false);
            output.innerHTML ="All clear"
    })
    </script>

    <script >
        var hr = parseInt('{{hr}}')
        var min = parseInt('{{min}}')
        var sec =parseInt('{{sec}}')
        console.log(typeof(hr))
    
            var newTime  = new Date()
            newTime.setDate(newTime.getDate())
            newTime.setHours(newTime.getHours()+hr)
            newTime.setMinutes(newTime.getMinutes() + min)
            newTime.setSeconds(newTime.getSeconds() + sec)
            console.log(newTime)
            var countDownDate = new Date(newTime).getTime();
         var x = setInterval(function(){
            var now = new Date().getTime();
            var distance = countDownDate - now
    
            var days = Math.floor(distance/(1000*60*60*24))
            var hours = Math.floor((distance%(1000*60*60*24))/(1000*60*60));
            var minutes = Math.floor((distance%(1000*60*60))/(1000*60));
            var seconds = Math.floor((distance%(1000*60))/(1000));
            if(distance>0){
            document.getElementById('hours').innerHTML =hours 
            document.getElementById('minutes').innerHTML =minutes 
            document.getElementById('seconds').innerHTML =seconds 
            }
            else{
                document.getElementById('form').submit();
            }
         } , 1000)

         //prevent back reloading of page
         
         $(document).ready(function(){
            function disableBack(){
                window.history.forward()
            }
            window.onload = disableBack()
            window.onpageshow = function(evt){
                if(evt.persisted) disableBack()
            }
         });
/*
         window.onload = function()
         {
            var e = document.getElementById("refreshed")
            if(e.value == "no") {
                e.value = "yes"
            }
            else {
                e.value ="no";
                location.reload();
            }
         }*/
         
         /*
         //this is for preventing for comming back after submiting form
         function preventBack()
         {
            window.history.forward();
         }
         setTimeout("preventBack()",0);
         window.onunload = function()
         {
            null
         };
        */
        </script> 
{%endblock content%}
